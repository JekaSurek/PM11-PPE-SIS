USE [master]
GO
/****** Object:  Database [БелкаФаворитСпичечнаяФабрикаБазаДанных]    Script Date: 23.05.2025 12:05:32 ******/
CREATE DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных]
 CONTAINMENT = NONE
 ON  PRIMARY 
( NAME = N'БелкаФаворитСпичечнаяФабрикаБазаДанных', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL16.MSSQLSERVER\MSSQL\DATA\БелкаФаворитСпичечнаяФабрикаБазаДанных.mdf' , SIZE = 73728KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )
 LOG ON 
( NAME = N'БелкаФаворитСпичечнаяФабрикаБазаДанных_log', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL16.MSSQLSERVER\MSSQL\DATA\БелкаФаворитСпичечнаяФабрикаБазаДанных_log.ldf' , SIZE = 73728KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )
 WITH CATALOG_COLLATION = DATABASE_DEFAULT, LEDGER = OFF
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET COMPATIBILITY_LEVEL = 160
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [БелкаФаворитСпичечнаяФабрикаБазаДанных].[dbo].[sp_fulltext_database] @action = 'enable'
end
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET ARITHABORT OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET AUTO_CLOSE OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET  DISABLE_BROKER 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET TRUSTWORTHY OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET READ_COMMITTED_SNAPSHOT OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET HONOR_BROKER_PRIORITY OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET RECOVERY FULL 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET  MULTI_USER 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET PAGE_VERIFY CHECKSUM  
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET DB_CHAINING OFF 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET TARGET_RECOVERY_TIME = 60 SECONDS 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET DELAYED_DURABILITY = DISABLED 
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET ACCELERATED_DATABASE_RECOVERY = OFF  
GO
EXEC sys.sp_db_vardecimal_storage_format N'БелкаФаворитСпичечнаяФабрикаБазаДанных', N'ON'
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET QUERY_STORE = ON
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET QUERY_STORE (OPERATION_MODE = READ_WRITE, CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 30), DATA_FLUSH_INTERVAL_SECONDS = 900, INTERVAL_LENGTH_MINUTES = 60, MAX_STORAGE_SIZE_MB = 1000, QUERY_CAPTURE_MODE = AUTO, SIZE_BASED_CLEANUP_MODE = AUTO, MAX_PLANS_PER_QUERY = 200, WAIT_STATS_CAPTURE_MODE = ON)
GO
USE [БелкаФаворитСпичечнаяФабрикаБазаДанных]
GO
/****** Object:  Table [dbo].[Выдача]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Выдача](
	[id_Выдачи] [int] IDENTITY(1,1) NOT NULL,
	[id_сотрудника] [int] NOT NULL,
	[id_сиз] [int] NOT NULL,
	[Дата_выдачи] [date] NOT NULL,
	[количество] [int] NOT NULL,
	[Срок_износа] [date] NULL,
	[Дата_создания] [datetime] NOT NULL,
	[Дата_изменения] [datetime] NOT NULL,
	[Кем_создана] [int] NULL,
 CONSTRAINT [PK_Выдача] PRIMARY KEY CLUSTERED 
(
	[id_Выдачи] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ДерматологическоеСредство]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ДерматологическоеСредство](
	[id_ДерматологическогоСредства] [int] IDENTITY(1,1) NOT NULL,
	[id_профессии] [int] NOT NULL,
	[Наименование] [nvarchar](100) NOT NULL,
	[Норма] [nvarchar](70) NOT NULL,
 CONSTRAINT [PK_ДерматологическоеСредство] PRIMARY KEY CLUSTERED 
(
	[id_ДерматологическогоСредства] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Инфраструктура]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Инфраструктура](
	[id_Инфраструктуры] [int] IDENTITY(1,1) NOT NULL,
	[Наименование] [nvarchar](100) NOT NULL,
	[Описание] [nvarchar](3000) NULL,
 CONSTRAINT [PK_Инфраструктура] PRIMARY KEY CLUSTERED 
(
	[id_Инфраструктуры] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[НормаВыдачи]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[НормаВыдачи](
	[id_Нормы] [int] IDENTITY(1,1) NOT NULL,
	[id_профессии] [int] NOT NULL,
	[id_сиз] [int] NOT NULL,
	[Норма_в_единицах_измерения] [varchar](80) NOT NULL,
	[Период] [varchar](50) NOT NULL,
	[Сезон] [int] NOT NULL,
	[Основание_назначения] [nvarchar](200) NOT NULL,
 CONSTRAINT [PK_НормаВыдачи] PRIMARY KEY CLUSTERED 
(
	[id_Нормы] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Пользователи]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Пользователи](
	[id_Пользователя] [int] IDENTITY(1,1) NOT NULL,
	[Логин] [nvarchar](80) NOT NULL,
	[Пароль] [nvarchar](40) NOT NULL,
	[id_роли] [int] NOT NULL,
	[Фамилия_сотрудника] [nvarchar](100) NULL,
	[Имя_сотрудника] [nvarchar](100) NULL,
	[Отчество_сотрудника] [nvarchar](100) NULL,
	[Дата_создания] [datetime] NULL,
	[Дата_изменения] [datetime] NULL,
	[Дата_последнего_входа] [datetime] NULL,
 CONSTRAINT [PK_Пользователи] PRIMARY KEY CLUSTERED 
(
	[id_Пользователя] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Профессия]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Профессия](
	[id_Профессии_или_должности] [int] IDENTITY(1,1) NOT NULL,
	[Наименование] [nvarchar](200) NOT NULL,
	[Код_по_нормативу] [nvarchar](100) NULL,
	[id_инфраструктуры_или_отдела] [int] NOT NULL,
 CONSTRAINT [PK_Профессия] PRIMARY KEY CLUSTERED 
(
	[id_Профессии_или_должности] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Роль]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Роль](
	[id_Роли] [int] IDENTITY(1,1) NOT NULL,
	[Наименование] [nvarchar](300) NOT NULL,
	[Описание] [nvarchar](3000) NULL,
 CONSTRAINT [PK_Роли] PRIMARY KEY CLUSTERED 
(
	[id_Роли] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Сезон]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Сезон](
	[id_Сезона] [int] IDENTITY(1,1) NOT NULL,
	[Наименование] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK_Сезон] PRIMARY KEY CLUSTERED 
(
	[id_Сезона] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[СИЗ]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[СИЗ](
	[id_СИЗ] [int] IDENTITY(1,1) NOT NULL,
	[Наименование] [nvarchar](200) NOT NULL,
	[id_типаСИЗ] [int] NOT NULL,
	[Единица_измерения] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK_СИЗ] PRIMARY KEY CLUSTERED 
(
	[id_СИЗ] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Сотрудник]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Сотрудник](
	[id_Сотрудника] [int] IDENTITY(1,1) NOT NULL,
	[id_профессии] [int] NOT NULL,
	[Фамилия] [nvarchar](100) NOT NULL,
	[Имя] [nvarchar](100) NOT NULL,
	[Отчество] [nvarchar](100) NULL,
 CONSTRAINT [PK_Сотрудник] PRIMARY KEY CLUSTERED 
(
	[id_Сотрудника] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ТипСИЗ]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ТипСИЗ](
	[id_Типа] [int] IDENTITY(1,1) NOT NULL,
	[Наименование] [nvarchar](100) NOT NULL,
	[Описание] [nvarchar](3000) NULL,
 CONSTRAINT [PK_ТипыСИЗ] PRIMARY KEY CLUSTERED 
(
	[id_Типа] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
ALTER TABLE [dbo].[Выдача]  WITH NOCHECK ADD  CONSTRAINT [FK_Выдача_Пользователи] FOREIGN KEY([Кем_создана])
REFERENCES [dbo].[Пользователи] ([id_Пользователя])
GO
ALTER TABLE [dbo].[Выдача] CHECK CONSTRAINT [FK_Выдача_Пользователи]
GO
ALTER TABLE [dbo].[Выдача]  WITH NOCHECK ADD  CONSTRAINT [FK_Выдача_СИЗ] FOREIGN KEY([id_сиз])
REFERENCES [dbo].[СИЗ] ([id_СИЗ])
GO
ALTER TABLE [dbo].[Выдача] CHECK CONSTRAINT [FK_Выдача_СИЗ]
GO
ALTER TABLE [dbo].[Выдача]  WITH NOCHECK ADD  CONSTRAINT [FK_Выдача_Сотрудник] FOREIGN KEY([id_сотрудника])
REFERENCES [dbo].[Сотрудник] ([id_Сотрудника])
GO
ALTER TABLE [dbo].[Выдача] CHECK CONSTRAINT [FK_Выдача_Сотрудник]
GO
ALTER TABLE [dbo].[ДерматологическоеСредство]  WITH NOCHECK ADD  CONSTRAINT [FK_ДерматологическоеСредство_Профессия] FOREIGN KEY([id_профессии])
REFERENCES [dbo].[Профессия] ([id_Профессии_или_должности])
GO
ALTER TABLE [dbo].[ДерматологическоеСредство] CHECK CONSTRAINT [FK_ДерматологическоеСредство_Профессия]
GO
ALTER TABLE [dbo].[НормаВыдачи]  WITH NOCHECK ADD  CONSTRAINT [FK_НормаВыдачи_Профессия] FOREIGN KEY([id_профессии])
REFERENCES [dbo].[Профессия] ([id_Профессии_или_должности])
GO
ALTER TABLE [dbo].[НормаВыдачи] CHECK CONSTRAINT [FK_НормаВыдачи_Профессия]
GO
ALTER TABLE [dbo].[НормаВыдачи]  WITH NOCHECK ADD  CONSTRAINT [FK_НормаВыдачи_Сезон] FOREIGN KEY([Сезон])
REFERENCES [dbo].[Сезон] ([id_Сезона])
GO
ALTER TABLE [dbo].[НормаВыдачи] CHECK CONSTRAINT [FK_НормаВыдачи_Сезон]
GO
ALTER TABLE [dbo].[НормаВыдачи]  WITH NOCHECK ADD  CONSTRAINT [FK_НормаВыдачи_СИЗ] FOREIGN KEY([id_сиз])
REFERENCES [dbo].[СИЗ] ([id_СИЗ])
GO
ALTER TABLE [dbo].[НормаВыдачи] CHECK CONSTRAINT [FK_НормаВыдачи_СИЗ]
GO
ALTER TABLE [dbo].[Пользователи]  WITH NOCHECK ADD  CONSTRAINT [FK_Пользователи_Роль] FOREIGN KEY([id_роли])
REFERENCES [dbo].[Роль] ([id_Роли])
GO
ALTER TABLE [dbo].[Пользователи] CHECK CONSTRAINT [FK_Пользователи_Роль]
GO
ALTER TABLE [dbo].[Профессия]  WITH NOCHECK ADD  CONSTRAINT [FK_Профессия_Инфраструктура] FOREIGN KEY([id_инфраструктуры_или_отдела])
REFERENCES [dbo].[Инфраструктура] ([id_Инфраструктуры])
GO
ALTER TABLE [dbo].[Профессия] CHECK CONSTRAINT [FK_Профессия_Инфраструктура]
GO
ALTER TABLE [dbo].[СИЗ]  WITH NOCHECK ADD  CONSTRAINT [FK_СИЗ_ТипСИЗ] FOREIGN KEY([id_типаСИЗ])
REFERENCES [dbo].[ТипСИЗ] ([id_Типа])
GO
ALTER TABLE [dbo].[СИЗ] CHECK CONSTRAINT [FK_СИЗ_ТипСИЗ]
GO
ALTER TABLE [dbo].[Сотрудник]  WITH NOCHECK ADD  CONSTRAINT [FK_Сотрудник_Профессия] FOREIGN KEY([id_профессии])
REFERENCES [dbo].[Профессия] ([id_Профессии_или_должности])
GO
ALTER TABLE [dbo].[Сотрудник] CHECK CONSTRAINT [FK_Сотрудник_Профессия]
GO
ALTER TABLE [dbo].[Выдача]  WITH NOCHECK ADD  CONSTRAINT [CHK_ДатыВыдачи] CHECK  (([Срок_износа] IS NULL OR [Срок_износа]>=[Дата_выдачи]))
GO
ALTER TABLE [dbo].[Выдача] CHECK CONSTRAINT [CHK_ДатыВыдачи]
GO
ALTER TABLE [dbo].[Выдача]  WITH NOCHECK ADD  CONSTRAINT [CHK_Количество] CHECK  (([количество]>(0)))
GO
ALTER TABLE [dbo].[Выдача] CHECK CONSTRAINT [CHK_Количество]
GO
/****** Object:  StoredProcedure [dbo].[sp_ДобавитьВыдачу]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[sp_ДобавитьВыдачу]
    @id_сотрудника INT,
    @id_сиз INT,
    @количество INT,
    @Кем_создана INT
AS
BEGIN
    INSERT INTO [Выдача] ([id_сотрудника], [id_сиз], [Дата_выдачи], [количество], [Дата_создания], [Дата_изменения], [Кем_создана])
    VALUES (@id_сотрудника, @id_сиз, GETDATE(), @количество, GETDATE(), GETDATE(), @Кем_создана);
END
GO
/****** Object:  StoredProcedure [dbo].[sp_ДобавитьПользователя]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[sp_ДобавитьПользователя]
    @Логин NVARCHAR(80),
    @Пароль NVARCHAR(40),
    @id_роли INT,
    @Фамилия_сотрудника NVARCHAR(100) = NULL,
    @Имя_сотрудника NVARCHAR(100) = NULL,
    @Отчество_сотрудника NVARCHAR(100) = NULL
AS
BEGIN
    SET NOCOUNT ON;
    
    INSERT INTO [Пользователи] (
        [Логин],
        [Пароль],
        [id_роли],
        [Фамилия_сотрудника],
        [Имя_сотрудника],
        [Отчество_сотрудника],
        [Дата_создания],
        [Дата_изменения]
    )
    VALUES (
        @Логин,
        @Пароль,
        @id_роли,
        @Фамилия_сотрудника,
        @Имя_сотрудника,
        @Отчество_сотрудника,
        GETDATE(), -- Явно устанавливаем дату создания
        GETDATE()  -- И дату изменения
    );
    
    SELECT SCOPE_IDENTITY() AS [id_Пользователя];
END
GO
/****** Object:  StoredProcedure [dbo].[sp_ОбновитьПользователя]    Script Date: 23.05.2025 12:05:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[sp_ОбновитьПользователя]
    @id_Пользователя INT,
    @Логин NVARCHAR(80),
    @Пароль NVARCHAR(40),
    @id_роли INT,
    @Фамилия_сотрудника NVARCHAR(100) = NULL,
    @Имя_сотрудника NVARCHAR(100) = NULL,
    @Отчество_сотрудника NVARCHAR(100) = NULL
AS
BEGIN
    UPDATE Пользователи SET
        Логин = @Логин,
        Пароль = @Пароль,
        id_роли = @id_роли,
        Фамилия_сотрудника = @Фамилия_сотрудника,
        Имя_сотрудника = @Имя_сотрудника,
        Отчество_сотрудника = @Отчество_сотрудника,
        Дата_изменения = GETDATE()
    WHERE id_Пользователя = @id_Пользователя
END
GO
USE [master]
GO
ALTER DATABASE [БелкаФаворитСпичечнаяФабрикаБазаДанных] SET  READ_WRITE 
GO

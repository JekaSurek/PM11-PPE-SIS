USE [БелкаФаворитСпичечнаяФабрикаБазаДанных]
GO

--Отключаем проверку ограничений
EXEC sp_MSforeachtable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL'

--Удаляем данные из таблиц (в правильном порядке)
DELETE FROM [Выдача];
DELETE FROM [НормаВыдачи];
DELETE FROM [ДерматологическоеСредство];
DELETE FROM [Сотрудник];
DELETE FROM [Пользователи];
DELETE FROM [СИЗ];
DELETE FROM [Профессия];
DELETE FROM [ТипСИЗ];
DELETE FROM [Сезон];
DELETE FROM [Роль];
DELETE FROM [Инфраструктура];

--Включаем проверку ограничений обратно
EXEC sp_MSforeachtable 'ALTER TABLE ? CHECK CONSTRAINT ALL'

--Сбрасываем счетчики IDENTITY
DBCC CHECKIDENT ('[Выдача]', RESEED, 0);
DBCC CHECKIDENT ('[НормаВыдачи]', RESEED, 0);
DBCC CHECKIDENT ('[ДерматологическоеСредство]', RESEED, 0);
DBCC CHECKIDENT ('[Сотрудник]', RESEED, 0);
DBCC CHECKIDENT ('[Пользователи]', RESEED, 0);
DBCC CHECKIDENT ('[СИЗ]', RESEED, 0);
DBCC CHECKIDENT ('[Профессия]', RESEED, 0);
DBCC CHECKIDENT ('[ТипСИЗ]', RESEED, 0);
DBCC CHECKIDENT ('[Сезон]', RESEED, 0);
DBCC CHECKIDENT ('[Роль]', RESEED, 0);
DBCC CHECKIDENT ('[Инфраструктура]', RESEED, 0);
GO

--Добавление ролей
INSERT INTO [Роль] ([Наименование], [Описание])
VALUES 
('Администратор', 'Полный доступ ко всем функциям системы'),
('Менеджер СИЗ', 'Основной пользователь системы учета СИЗ'),
('Бухгалтер', 'Учет финансовых операций по СИЗ');
GO

--Добавление инфраструктуры
INSERT INTO [Инфраструктура] ([Наименование], [Описание])
VALUES 
('Цех по производству спичек', 'Основное производство спичек и спичечных коробок'),
('Транспортный участок', 'Логистика и перевозки сырья и готовой продукции'),
('Лесная биржа', 'Хранение и подготовка древесного сырья'),
('Паросиловое хозяйство', 'Энергетический комплекс предприятия'),
('Ремонтный цех', 'Техническое обслуживание и ремонт оборудования');
GO

--Добавление сезонов
INSERT INTO [Сезон] ([Наименование])
VALUES 
('Лето'),
('Зима'),
('Всесезонный');
GO

--Добавление типов СИЗ
INSERT INTO [ТипСИЗ] ([Наименование], [Описание])
VALUES 
('Спецодежда', 'Защитная одежда для различных производственных условий'),
('Спецобувь', 'Защитная обувь от механических и других воздействий'),
('СИЗ органов дыхания', 'Респираторы, маски и другие средства защиты дыхания'),
('СИЗ головы', 'Каски, подшлемники и другие средства защиты головы'),
('СИЗ рук', 'Перчатки, рукавицы и другие средства защиты рук');
GO

--Добавление профессий (ссылается на Инфраструктуру)
INSERT INTO [Профессия] ([Наименование], [Код_по_нормативу], [id_инфраструктуры_или_отдела])
VALUES 
('Оператор автоматической линии изготовления спичек', '2979', 1),
('Машинист крана (крановщик)', '2122', 2),
('Грузчик', '987', 2),
('Дворник', '997', 1),
('Аппаратчик по производству сухой спичечной соломки', '1234', 1),
('Электросварщик ручной сварки', '5321', 5);
GO

--Добавление СИЗ (ссылается на ТипСИЗ)
INSERT INTO [СИЗ] ([Наименование], [id_типаСИЗ], [Единица_измерения])
VALUES 
('Костюм хлопчатобумажный', 1, 'шт.'),
('Сабо защитные', 2, 'пара'),
('Перчатки хлопчатобумажные', 5, 'пара'),
('Каска защитная', 4, 'шт.'),
('Респиратор У-2К', 3, 'шт.'),
('Костюм для защиты от механических воздействий', 1, 'шт.'),
('Обувь специальная для защиты от ударов', 2, 'пара');
GO

--Добавление сотрудников (ссылается на Профессию)
INSERT INTO [Сотрудник] ([id_профессии], [Фамилия], [Имя], [Отчество])
VALUES 
(1, 'Иванов', 'Петр', 'Сергеевич'),
(2, 'Сидоров', 'Алексей', 'Николаевич'),
(3, 'Петров', 'Иван', 'Дмитриевич'),
(4, 'Кузнецов', 'Дмитрий', 'Анатольевич'),
(5, 'Смирнов', 'Алексей', 'Игоревич'),
(6, 'Ковалев', 'Дмитрий', 'Сергеевич');
GO

--Добавление пользователей(ссылается на Роль)
INSERT INTO [Пользователи] ([Логин], [Пароль], [id_роли], [Фамилия_сотрудника], [Имя_сотрудника], [Отчество_сотрудника], [Дата_создания], [Дата_изменения])
VALUES 
('admin', 'admin1', 1, 'Администратор', 'Системы', NULL, GETDATE(), GETDATE()),
('manager1', 'managerpass', 2, 'Лебедев', 'Александр', 'Дмитриевич', GETDATE(), GETDATE()),
('siz_manager', 'mng123', 2, 'Иванова', 'Мария', 'Сергеевна', GETDATE(), GETDATE()),
('siz_admin', 'adm456', 1, 'Петров', 'Сергей', 'Иванович', GETDATE(), GETDATE());
GO

--Добавление норм выдачи(ссылается на Профессию, СИЗ и Сезон)
INSERT INTO [НормаВыдачи] ([id_профессии], [id_сиз], [Норма_в_единицах_измерения], [Период], [Сезон], [Основание_назначения])
VALUES 
(1, 1, '1', '1 год', 3, 'Типовые нормы выдачи СИЗ'),
(1, 2, '1', '1 год', 3, 'Типовые нормы выдачи СИЗ'),
(1, 3, '12', '1 год', 3, 'Типовые нормы выдачи СИЗ'),
(2, 6, '1', '1 год', 3, 'Типовые нормы выдачи СИЗ'),
(2, 7, '1', '1 год', 3, 'Типовые нормы выдачи СИЗ'),
(5, 1, '1', '1 год', 3, 'Типовые нормы выдачи СИЗ'),
(6, 4, '1', '2 года', 3, 'Типовые нормы выдачи СИЗ');
GO

--Добавление дерматологических средств (ссылается на Профессию)
INSERT INTO [ДерматологическоеСредство] ([id_профессии], [Наименование], [Норма])
VALUES 
(5, 'Защитный крем для рук', '100 мл в месяц'),
(5, 'Очищающая паста', '200 мл в месяц'),
(2, 'Регенерирующий крем', '150 мл в месяц'),
(6, 'Специальное очищающее средство для сварщиков', '300 мл в месяц'),
(6, 'Защитный крем от металлической пыли', '200 мл в месяц');
GO

--Добавление записей о выдаче СИЗ (ссылается на Сотрудника, СИЗ и Пользователя)
INSERT INTO [Выдача] ([id_сотрудника], [id_сиз], [Дата_выдачи], [количество], [Срок_износа], [Дата_создания], [Дата_изменения], [Кем_создана])
VALUES 
(1, 1, '2024-01-15', 1, '2025-01-15', GETDATE(), GETDATE(), 1),
(1, 2, '2024-01-15', 1, '2024-07-15', GETDATE(), GETDATE(), 1),
(1, 3, '2024-01-15', 12, NULL, GETDATE(), GETDATE(), 1),
(2, 6, '2024-02-20', 1, '2025-02-20', GETDATE(), GETDATE(), 2),
(2, 7, '2024-02-20', 1, '2024-08-20', GETDATE(), GETDATE(), 2),
(2, 4, '2024-02-20', 1, '2026-02-20', GETDATE(), GETDATE(), 2),
(5, 1, '2024-03-10', 1, '2025-03-10', GETDATE(), GETDATE(), 3),
(5, 3, '2024-03-10', 12, NULL, GETDATE(), GETDATE(), 3),
(6, 4, '2024-04-05', 1, '2026-04-05', GETDATE(), GETDATE(), 4),
(6, 5, '2024-04-05', 2, NULL, GETDATE(), GETDATE(), 4);
GO